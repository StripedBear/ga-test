<div class="container">
  <h2 class="u-fs-huge text-center mb-6 mb-lg-8">Clients & Partners</h2>
  <ul class="c-partners">
    {{ $logos := split .Inner "\n" }}
    {{ range $logos }}
      {{ $line := trim . " \t\r" }}
      {{ if and $line (ne $line "") }}

        {{ $parts := split $line "|" }}
        {{ $logo := trim (index $parts 0) " " }}
        {{ $link := "" }}
        {{ if gt (len $parts) 1 }}
          {{ $link = trim (index $parts 1) " " }}
        {{ end }}

        {{ $imgResource := false }}
        {{ if $.Page.Resources }}
          {{ $imgResource = $.Page.Resources.Get $logo }}
          {{ if not $imgResource }}
            {{ $imgResource = $.Page.Resources.GetMatch (printf "*%s*" $logo) }}
          {{ end }}
        {{ end }}

        {{ $altText := $logo | replaceRE `\.(png|jpg|jpeg)$` "" | replaceRE `[-_]` " " | title }}

        <li class="c-partners__item">
          {{ if $link }}
            <a href="{{ $link }}" target="_blank" rel="noopener">
          {{ end }}

          {{ if $imgResource }}
            <img src="{{ $imgResource.RelPermalink }}" alt="{{ $altText }}" />
          {{ else }}
            <img src="{{ (printf "/img/%s" $logo) | relURL }}" alt="{{ $altText }}" />
          {{ end }}

          {{ if $link }}
            </a>
          {{ end }}
        </li>

      {{ end }}
    {{ end }}
  </ul>
</div>
